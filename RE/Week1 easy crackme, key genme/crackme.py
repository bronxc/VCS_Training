str = "01 00 00 00 00 00 00 00 74 CC CC CC 01 00 00 00  01 00 00 00 48 CC CC CC 01 00 00 00 02 00 00 00  3B CC CC CC 02 00 00 00 88 00 00 00 81 24 CC CC  03 00 00 00 6F 00 00 00 63 33 59 6F 02 00 00 00  84 00 00 00 01 01 CC CC 02 00 00 00 0A 00 00 00  35 AF CC CC 01 00 00 00 D0 00 00 00 33 CC CC CC  03 00 00 00 0F 00 00 00 64 4D 78 76 04 00 00 00  12 00 00 00 DD 20 B1 1A 01 00 00 00 06 01 00 00  0C CC CC CC 03 00 00 00 E8 00 00 00 6A 44 42 35  02 00 00 00 1D 00 00 00 A6 21 CC CC 02 00 00 00  1F 00 00 00 BE 8A CC CC 01 00 00 00 21 00 00 00  4C CC CC CC 02 00 00 00 22 00 00 00 26 0E CC CC  01 00 00 00 24 00 00 00 35 CC CC CC 01 00 00 00  5D 00 00 00 3B CC CC CC 03 00 00 00 2B 00 00 00  6A 45 39 75 04 00 00 00 16 00 00 00 88 3F ED 0D  03 00 00 00 EB 00 00 00 6A 33 56 7A 02 00 00 00  32 00 00 00 35 AF CC CC 02 00 00 00 30 00 00 00  AB 2F CC CC 02 00 00 00 08 00 00 00 81 36 CC CC  03 00 00 00 34 00 00 00 6A 6C 63 75 01 00 00 00  37 00 00 00 00 CC CC CC 02 00 00 00 38 00 00 00  25 3C CC CC 03 00 00 00 53 00 00 00 49 46 52 67  01 00 00 00 3E 00 00 00 21 CC CC CC 01 00 00 00  3F 00 00 00 54 CC CC CC 01 00 00 00 92 00 00 00  37 CC CC CC 01 00 00 00 86 00 00 00 74 CC CC CC  04 00 00 00 09 01 00 00 C0 36 FD 13 01 00 00 00  4A 00 00 00 00 CC CC CC 01 00 00 00 0D 01 00 00  52 CC CC CC 04 00 00 00 4D 00 00 00 C1 3D BA 43  03 00 00 00 1C 01 00 00 64 32 77 6F 04 00 00 00  3A 00 00 00 CD 73 B0 0C 04 00 00 00 56 00 00 00  CD 73 B9 06 03 00 00 00 5A 00 00 00 51 32 6D 79  04 00 00 00 0F 01 00 00 CB 36 AE 10 01 00 00 00  5E 00 00 00 3D CC CC CC 02 00 00 00 5F 00 00 00  01 21 CC CC 04 00 00 00 68 00 00 00 88 27 B5 06  01 00 00 00 BA 00 00 00 44 CC CC CC 04 00 00 00  9A 00 00 00 DC 3A BA 06 03 00 00 00 6C 00 00 00  49 46 4A 6D 04 00 00 00 04 00 00 00 88 62 AE 43  04 00 00 00 72 00 00 00 C1 20 FD 0E 02 00 00 00  C7 00 00 00 3D 86 CC CC 01 00 00 00 7A 00 00 00  2B CC CC CC 04 00 00 00 7B 00 00 00 88 27 B8 0D  01 00 00 00 C6 00 00 00 0E CC CC CC 01 00 00 00  83 00 00 00 2B CC CC CC 01 00 00 00 03 00 00 00  01 CC CC CC 04 00 00 00 93 00 00 00 88 23 BC 13  04 00 00 00 A9 00 00 00 88 37 B2 43 03 00 00 00  0C 00 00 00 5A 47 6D 43 04 00 00 00 8A 00 00 00  CE 36 BC 11 04 00 00 00 8E 00 00 00 DB 73 BC 11  04 00 00 00 AF 00 00 00 D1 27 B5 0A 02 00 00 00  44 00 00 00 25 A5 CC CC 01 00 00 00 97 00 00 00  37 CC CC CC 02 00 00 00 98 00 00 00 01 2F CC CC  04 00 00 00 61 00 00 00 DC 3C FD 02 01 00 00 00  9E 00 00 00 52 CC CC CC 04 00 00 00 9F 00 00 00  DB 7D FD 3A 04 00 00 00 46 00 00 00 CB 26 B1 17  01 00 00 00 A7 00 00 00 33 CC CC CC 01 00 00 00  2F 00 00 00 00 CC CC CC 01 00 00 00 87 00 00 00  48 CC CC CC 01 00 00 00 AD 00 00 00 33 CC CC CC  01 00 00 00 AE 00 00 00 4E CC CC CC 04 00 00 00  C9 00 00 00 C7 26 FD 00 02 00 00 00 B3 00 00 00  22 A1 CC CC 01 00 00 00 B5 00 00 00 00 CC CC CC  04 00 00 00 B6 00 00 00 D1 3C A8 43 03 00 00 00  65 00 00 00 51 33 59 73 01 00 00 00 BB 00 00 00  37 CC CC CC 01 00 00 00 BC 00 00 00 31 CC CC CC  04 00 00 00 D2 00 00 00 DC 73 A9 0C 03 00 00 00  BF 00 00 00 5A 54 42 38 02 00 00 00 C2 00 00 00  81 21 CC CC 01 00 00 00 DA 00 00 00 4E CC CC CC  04 00 00 00 7F 00 00 00 C9 30 B4 17 04 00 00 00  76 00 00 00 CD 21 B8 0F 04 00 00 00 FB 00 00 00  CD 73 AD 11 02 00 00 00 CD 00 00 00 A6 26 CC CC  01 00 00 00 CF 00 00 00 00 CC CC CC 02 00 00 00  4B 00 00 00 25 2C CC CC 01 00 00 00 D1 00 00 00  31 CC CC CC 02 00 00 00 BD 00 00 00 A3 22 CC CC  03 00 00 00 13 01 00 00 49 47 6D 79 02 00 00 00  C4 00 00 00 26 A4 CC CC 03 00 00 00 EF 00 00 00  6A 47 6D 6C 04 00 00 00 DC 00 00 00 CD 73 BC 0D  01 00 00 00 EE 00 00 00 00 CC CC CC 04 00 00 00  E4 00 00 00 C6 27 AF 0C 03 00 00 00 1A 00 00 00  5A 31 39 55 01 00 00 00 2E 00 00 00 35 CC CC CC  04 00 00 00 E0 00 00 00 CC 73 BE 0C 01 00 00 00  DB 00 00 00 35 CC CC CC 02 00 00 00 F2 00 00 00  8C A4 CC CC 04 00 00 00 F4 00 00 00 88 32 B3 07  02 00 00 00 25 00 00 00 A7 39 CC CC 04 00 00 00  40 00 00 00 88 37 B4 05 01 00 00 00 FF 00 00 00  3D CC CC CC 03 00 00 00 00 01 00 00 51 32 56 6B  03 00 00 00 03 01 00 00 64 58 4A 6D 04 00 00 00  27 00 00 00 C7 1D BA 3C 02 00 00 00 07 01 00 00  2B 06 CC CC 04 00 00 00 A3 00 00 00 C7 26 FD 00  01 00 00 00 A8 00 00 00 4E CC CC CC 01 00 00 00  0E 01 00 00 3D CC CC CC 03 00 00 00 F8 00 00 00  49 46 52 67 04 00 00 00 D6 00 00 00 88 30 B5 02  02 00 00 00 16 01 00 00 25 86 CC CC 04 00 00 00  18 01 00 00 DC 20 FD 0C 02 00 00 00 51 00 00 00  A8 A2 CC CC 03 00 00 00 1F 01 00 00 63 6C 56 33  03 00 00 00 22 01 00 00 51 58 4A 6B 01 00 00 00  25 01 00 00 0E CC CC CC 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00"
data = "41 42 44 43 45 48 47 46 49 4A 4B 4C 55 4E 4F 50 59 52 54 53 4D 56 57 58 51 5A 61 6A 63 64 65 66 6F 68 69 62 6B 6D 6C 6E 67 70 71 72 73 74 75 76 34 78 7A 79 38 31 32 33 77 35 36 37 30 39 2B 30"
buffData = "73 E9 39 D0 98 BB D6 23 16 19 FC 7C 0F 32 80 B2 9C 57 36 9E 91 4D DF 7A 08 42 76 A5 11 AD 3E D2 65 4F 71 20 A0 28 C3 33 4E 6C 79 95 AF 6B C8 70 A2 41 92 BA 4B D1 E3 BC 2B F4 1C 46 78 D9 B6 04 ED 96 68 97 F5 09 3A 25 EB BE 49 D8 6D B5 13 7E 00 77 6F B4 0E 1D B7 2C CA 7F 3C 5F 7D A9 88 C4 C0 5E 18 CD E0 0C 62 29 54 84 07 47 C9 F7 2E 06 E2 24 83 E4 52 15 45 43 DA 31 82 87 B8 14 E7 CF E5 40 1A DD 9A 35 85 F3 63 B1 F0 3D 0D EA 8B EE 99 AE A4 51 A8 1E 1B C5 34 4C FD FF EC 37 64 75 05 01 8C 21 A3 60 50 6A B9 5C 53 CE 26 C1 3B F2 3F 66 CC 2F A1 94 56 59 4A 9F D7 89 48 5B 12 9D 8F 55 D5 BF 5D 2D F8 1F 30 0B 5A 44 67 2A 38 F9 F6 6E 7B EF E8 8A DE C7 F1 A7 CB DC D4 D3 27 FE 10 02 BD 90 FA E1 69 E6 72 AB AC 22 8E 86 9B FB A6 17 B3 61 74 C6 C2 58 B0 AA DB 93 8D 03 0A 81 00 00 E3 00 00 00 E2 00 EB 00 00 00 00 10 00 00"
strIn = '_' * 294
strArr = list(strIn)

arrCheck = []

def init():
    arrCheck = str.split()
    for i in range(len(arrCheck)):
        arrCheck[i] = int(arrCheck[i], 16)

    return arrCheck



#length = 294 -> 300
#arrCheck 00404BE8 => 004051BF


#checkElem[]
#3 gia tri, 1 => case, 2 => char offset, 3 => keycheck (lay 4 byte, but chir lay gia tri byte dau)
#2 =>
#a1 case
#a2 input


def case1(iInOff, iCCheck):
    vCheck = arrCheck[iCCheck] % 2
    if vCheck:
        strArr[iInOff] = chr(arrCheck[iCCheck] ^ 82) #0x52
    else:
        strArr[iInOff] = chr(arrCheck[iCCheck] ^ 32) #0x20

    return 0

def case2(iInOff, iCCheck):
    iCC1 = arrCheck[iCCheck]
    iCC2 = arrCheck[iCCheck+1]
    #print(iCC1, iCC2)
    iCC = (iCC2 << 8) + iCC1

    for i in range (5, 0, -1):
        iCC = iCC ^ 0x1693
        iCC = (iCC << (16 -i)) | (iCC >> i)
        iCC = iCC & 0xffff

    strArr[iInOff] = chr(iCC >> 8)
    strArr[iInOff+1] = chr(iCC & 0xff)

    #print(iInOff, strArr[iInOff], chr(iCC >> 8), chr(iCC & 0xff))
    return 0


def case3(iInOff, iCCheck):
    
    for v3 in range(0x20,0x80):
        if listdata[v3 & 0x3f] == arrCheck[iCCheck + 3]:  
            for v2 in range(0x20,0x80):
                idx = ((v3 & 0xc0) >> 6)  + (v2 & 0xf)*4
                if listdata[idx] == arrCheck[iCCheck + 2]:
                    #print(i,j)
                    for v1 in range(0x20, 0x80):
                        idx2 = ((v2 & 0xf0) >> 4) + 16 * (v1 & 3)
                        if listdata[idx2] == arrCheck[iCCheck + 1]:
                            if listdata[(v1 & 0xfc) >> 2] == arrCheck[iCCheck]:
                                #print(v1, v2, v3)
                                strArr[iInOff] = chr(v1)
                                strArr[iInOff + 1] = chr(v2)
                                strArr[iInOff + 2] = chr(v3)

cnt4 = 0
cnt1 = 0
cnt2 = 0
cnt3 = 0

def case4(buffArr, iInOff, iCCheck):
    #strArr buffer
    #iInOff offset of first character
    #iCCheck offset of first check character

    #print(iInOff, "case4")
    
    v8 = 0
    v7 = 0
    v6 = 0
    v5 = 4
    
    for v6 in range (v5):
        v8 = (v8 + 1) % 256
        v7 = (v7 + buffArr[v8]) % 256
        v3 = buffArr[v8]
        buffArr[v8] = buffArr[v7]
        buffArr[v7] = v3

        for char in range(0x20, 0x80):
            check = (buffArr[v7] + buffArr[v8]) % 256
            check = buffArr[check]
            check = check ^ char #arrCheck[iInOff + v6]
            if check == arrCheck[iCCheck + v6]:
                #print(char, chr(char))
                strArr[iInOff + v6] = chr(char)
                
#######################################3
arrCheck = init()
listdata = data.split(" ")
for i in range(0,len(listdata)):
    listdata[i] = int(listdata[i],16)

buffArr = buffData.split()
for i in range(len(buffArr)):
    buffArr[i] = int(buffArr[i], 16)

    
itr = 0

for i in range(125):
    iCase = arrCheck[itr]
    
    #iInOff = arrCheck[itr+4]
    iInOff = arrCheck[itr+4] + arrCheck[itr+5]*2**8 + arrCheck[itr+6]*2**16 + arrCheck[itr+7]*2**24
    iCCheck = itr+8

    itr += 12
    
    if iCase == 1:
        #iInOff = arrCheck[itr+4]
        cnt1+=1
        case1(iInOff, iCCheck)

    if iCase == 2:
        cnt2+=1
        case2(iInOff, iCCheck)

    if iCase == 3:
        cnt3+=1
        case3(iInOff, iCCheck)

    if iCase == 4:
        buffArr = buffData.split()
        for i in range(len(buffArr)):
            buffArr[i] = int(buffArr[i], 16)

        cnt4+=1
        case4(buffArr, iInOff, iCCheck)

output = ''
output = output.join(strArr)
'''
iInOff = arrCheck[4*12 + 4]
iCCheck = 4*12 + 8
case3(iInOff, iCCheck)
'''
print(output)
